<app-navbar></app-navbar>

<div class="page-container">
  <header class="page-header">
    <h1>Cadastrar Produto para Doação</h1>
    <p>Preencha as informações do produto que deseja doar</p>
  </header>

  <form (ngSubmit)="handleSubmit()" class="form-card">
    <div class="form-grid">
      <div class="form-group">
        <label for="nome">Nome do Produto *</label>
        <input type="text" id="nome" name="nome" [(ngModel)]="formData.nome" placeholder="Ex: Notebook Dell Inspiron 15" required>
      </div>

      <div class="form-group">
        <label for="imagem">Imagem do Produto</label>

        <div *ngIf="!imagePreview; else previewTpl">
          <label for="fileInput" class="file-input-container">
            <lucide-icon [name]="lucideUpload" size="40" class="upload-icon"></lucide-icon>
            <span class="file-input-text">Clique para escolher um arquivo</span>
            <span class="file-input-subtext">PNG, JPG, GIF até 10MB</span>
          </label>
          <input type="file" id="fileInput" class="file-input-hidden" (change)="onFileSelected($event)" accept="image/*">
        </div>

        <ng-template #previewTpl>
          <div class="image-preview-container">
            <img [src]="imagePreview" alt="Pré-visualização da imagem" class="preview-image">
            <button type="button" class="remove-image-btn" (click)="removeImage()" aria-label="Remover imagem">
              <lucide-icon [name]="lucideX" size="16"></lucide-icon>
            </button>
          </div>
        </ng-template>
      </div>

      <div class="form-row">
      </div>

       <div class="form-row">
        <div class="form-group">
          <label for="categoria">Categoria *</label>
          <select id="categoria" name="categoria" [(ngModel)]="formData.categoria" required>
            <option value="" disabled>Selecione uma categoria</option>
            <option *ngFor="let cat of categorias" [value]="cat.value">{{ cat.label }}</option>
          </select>
        </div>
        <div class="form-group">
          <label for="estado">Estado de Conservação *</label>
          <select id="estado" name="estadoConservacao" [(ngModel)]="formData.estadoConservacao" required>
            <option value="" disabled>Selecione o estado</option>
            <option *ngFor="let est of estados" [value]="est.value">{{ est.label }}</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label for="observacoes">Observações *</label>
        <textarea id="observacoes" name="observacoes" [(ngModel)]="formData.observacoes" rows="4" placeholder="Descreva o produto, seu estado, funcionalidades, acessórios incluídos, etc." required></textarea>
      </div>

      <div class="form-group">
        <label for="entrega">Local de Entrega *</label>
        <input type="text" id="entrega" name="enderecoEntrega" [(ngModel)]="formData.enderecoEntrega" placeholder="Ex: Shopping Iguatemi - Praça de Alimentação" required>
        <small>Informe um local público e seguro para a entrega</small>
      </div>

      <div class="form-group">
        <label for="cidade">Cidade</label>
        <input type="text" id="cidade" name="cidade" [(ngModel)]="formData.cidade" [readonly]="true">
        <small>Baseado no seu perfil de usuário</small>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-primary" [disabled]="loading">
        {{ loading ? 'Cadastrando...' : 'Cadastrar Produto' }}
      </button>
      <button type="button" class="btn btn-secondary" (click)="cancelar()">
        Cancelar
      </button>
    </div>
  </form>
</div>
